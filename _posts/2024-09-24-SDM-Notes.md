---
layout: post
title: Notes of Score Diffusion Models (updating) 
date: 2024-09-24 20:00:00-0400
description: basics of score diffusion models
comments: true
tags: Bayes Deep-Learning Diffusion-Model
---
**Table of Contents**
- [Unified Framework by Stochastic Differential Equations (SDE)](#unified-framework-by-stochastic-differential-equations-sde)
  - [Recap of NCSN and DDPM](#recap-of-ncsn-and-ddpm)
  - [Data Perturbation with Itô SDE](#data-perturbation-with-itô-sde)
  - [Reverse SDE](#reverse-sde)
  - [Probability Flow ODE](#probability-flow-ode)
- [More General: EDM](#more-general-edm)
- [Sampling Methods](#sampling-methods)


# Unified Framework by Stochastic Differential Equations (SDE)

In [Score-Based Generative Modeling through Stochastic Differential Equations](https://arxiv.org/abs/2011.13456), the authors propose a unified framework that connects the score-based model NCSN and DDPM through the perspective of Stochastic Differential Equations (SDE). They interpret the forward process (adding noise) and the backward process (denoising sampling) as SDE and reverse SDE, respectively.

## Recap of NCSN and DDPM

DDPM and NCSN are essentially the same model but with different perturbation kernel. Let's use the notation from NCSN. In DDPM, we have a sequence of noise scales $0 < \beta_1 < \beta_2,...,\beta_N < 1$ and the perturbation kernel is $p_{\alpha_i}(\tilde{\x}\mid \x) = \N(\tilde{\x}\mid \sqrt{\alpha_i}\x, (1-\alpha_i)\I)$ where $\alpha_i=\prod_{j=1}^i\beta_j$. The objective function can be rewritten as 

$$
L_{simple} = (1-\alpha_i)\mathbb{E}_{p_{\alpha_i}}\mathbb{E}_{p_{data}}\sbr{\left\lVert\bm{s}_\theta(\tilde{\x},\alpha_i) + \frac{\tilde{\x}-\sqrt{\alpha_i}\x}{(1-\alpha_i)}\right\rVert^2_2}.
$$

We found that the scale factor $1-\alpha_i \propto \frac{1}{\left\lVert\frac{\tilde{\x}-\sqrt{\alpha_i}\x}{(1-\alpha_i)}\right\rVert^2_2}$, which is similar to the one in NCSN. 

## Data Perturbation with Itô SDE

$$
d\x = \f(\x, t)dt + g(t)d\w
$$

- $\w$: standard Wiener process
- $\f(\cdot,t): \mathbb{R}^D \rightarrow \mathbb{R}^D$ drift coefficient
- $g(\cdot): \mathbb{R} \rightarrow \mathbb{R}$ diffusion coefficient of $\x_t$

## Reverse SDE

$$
d\x = \sbr{\f(\x,t) - g(t)^2\nabla_{\x}\log p_t(\x)} + g(t)d\bar{\w}
$$

## Probability Flow ODE

# More General: EDM

# Sampling Methods
